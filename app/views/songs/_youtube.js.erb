<script>
var tag = document.createElement('script');
tag.src = "http://www.youtube.com/player_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
var done = false;
var player;
function onYouTubePlayerAPIReady() {
  player = new YT.Player('player', {
    width: '940',
    videoId: "<%= song.youtube_id %>",
    events: {
      'onReady': onPlayerReady,
      'onStateChange': onPlayerStateChange
    }
  });
}
function onPlayerReady(evt) {
  evt.target.playVideo();
}
function onPlayerStateChange(evt) {
  if (evt.data == YT.PlayerState.PLAYING && !done) {
    done = true;
  }
  else if (evt.data == YT.PlayerState.PAUSED) {
    console.log("paused");
  }
  else if (evt.data == YT.PlayerState.PLAYING) {
    console.log("playing");
  }
}
function stopVideo() {
  player.stopVideo();
}

function getPlayerTime() {
  return player.getCurrentTime();
}
</script>
